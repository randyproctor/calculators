<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Disney Tickets</title>
<style type="text/css">
th {
/*
	text-align: left;
*/
}
.amount {
	text-align: right;
	font-family: monospace;
	font-size: 1.2em;
}
.days {
	width: 4em;
}
.check {
	text-align: center;
}
td {
	background-color: #f7f7f7;
}
</style>
<script language="javascript">

function getDailyPrice(park, days, hop, water)
{
	switch (park) {
		case "wdw":
			if (hop && water) {
				switch (days)
				{
					case  1: return 195;
					case  2: return 282;
					case  3: return 365;
					case  4: return 395;
					case  5: return 405;
					case  6: return 415;
					case  7: return 425;
					case  8: return 435;
					case  9: return 445;
					case 10: return 455;
				}
			} else if (water) {
				switch (days)
				{
					case  1: return 169;
					case  2: return 256;
					case  3: return 339;
					case  4: return 369;
					case  5: return 379;
					case  6: return 389;
					case  7: return 399;
					case  8: return 409;
					case  9: return 419;
					case 10: return 429;
				}
			} else if (hop) {
				switch (days)
				{
					case  1: return 155;
					case  2: return 242;
					case  3: return 325;
					case  4: return 369;
					case  5: return 379;
					case  6: return 389;
					case  7: return 399;
					case  8: return 409;
					case  9: return 419;
					case 10: return 429;
				}
			} else {
				switch (days)
				{
					case  1: return 105;
					case  2: return 192;
					case  3: return 275;
					case  4: return 305;
					case  5: return 315;
					case  6: return 325;
					case  7: return 335;
					case  8: return 345;
					case  9: return 355;
					case 10: return 365;
				}
			}
			break;
		case "dlr":
			var ap = 0;
			switch (days)
			{
				case 1: ap =  99;
				case 2: ap = 185;
				case 3: ap = 235;
				case 4: ap = 260;
				case 5: ap = 275;
				default: break;
			}
			if (ap > 0) {
				if (hop) ap += 40;
				return ap;
			}
	}

	if (days > 0) {
		document.getElementById('id_message').innerHTML =
			'No ticket prices available for ' + days + ' days at ' + park + '.';
	}

	return 0.00;
}

function getAPPrice(park, days, premium)
{
	if (days > 0) {
		switch (park) {
			case "wdw":
				if (premium) {
					return 779;
				} else {
					return 654;
				}
			case "dlr":
				return 779;
		}
	}

	return 0.00;
}

function getPremierPrice()
{
	return 1099;
}

function prettyAmount(amount)
{
	return '$' + Number(amount).toLocaleString('en');
}

var NUM_ROWS = 3;

function calculatePrices(form)
{
	var parkMax = new Object();
	var totalDaily = 0;

	for (i = 1; i <= NUM_ROWS; i++) {
		var park = document.getElementById('id_park' + i).value;
		var days = parseInt(document.getElementById('id_days' + i).value);
		var hop = document.getElementById('id_hop' + i).checked;
		var water = document.getElementById('id_water' + i).checked;

		var daily = getDailyPrice(park, days, hop, water);
		document.getElementById('id_daily' + i).innerHTML = prettyAmount(daily);
		totalDaily += daily;

		var premium = ((park == "wdw") && water);
		var ap = getAPPrice(park, days, premium);
		document.getElementById('id_ap' + i).innerHTML = prettyAmount(ap);

		if (!(park in parkMax) || (ap > parkMax[park])) parkMax[park] = ap;
	}

	document.getElementById('id_total_daily').innerHTML =
		prettyAmount(totalDaily);

	var maxAp = 0;
	for (var p in parkMax) {
		maxAp += parkMax[p];
	}
	document.getElementById('id_total_ap').innerHTML = prettyAmount(maxAp);

	{
		var pp = getPremierPrice();
		document.getElementById('id_total_pp').innerHTML = prettyAmount(pp);
	}
}

function createTr()
{
	return document.createElement('tr');
}

function createTd()
{
	return document.createElement('td');
}

function createTdWithChild(className, child)
{
	var e = createTd();

	e.setAttribute('class', className);
	e.appendChild(child);

	return e;
}

function createTdStr(className, str)
{
	return createTdWithChild(className, document.createTextNode(str));
}

function createSelect(id, name)
{
	var select = document.createElement('select');

	select.setAttribute('id', id);
	select.setAttribute('name', name);

	return select;
}

function createOption(value, str)
{
	var option = document.createElement('option');

	option.setAttribute('value', value);
	option.appendChild(document.createTextNode(str));

	return option;
}

function createNumberInput(id, classStr, name, min, max, value)
{
	var input = document.createElement('input');

	input.setAttribute('id', id);
	input.setAttribute('type', 'number');
	input.setAttribute('class', classStr);
	input.setAttribute('name', name);
	input.setAttribute('min', min);
	input.setAttribute('max', max);
	input.setAttribute('value', value);

	return input;
}

function createCheckboxInput(id, name)
{
	var checkbox = document.createElement('input');

	checkbox.setAttribute('id', id);
	checkbox.setAttribute('type', 'checkbox');
	checkbox.setAttribute('name', name);

	return checkbox;
}

function createLabel(id)
{
	var e = document.createElement('label');

	e.setAttribute('id', id);

	return e;
}

function createThWithChild(child)
{
	var e = document.createElement('th');

	e.appendChild(child);

	return e;
}

function createThStr(str)
{
	return createThWithChild(document.createTextNode(str));
}

function buildInputTable()
{
	var old_tbody = document.getElementById('inputTable');
	var new_tbody = document.createElement('tbody');
	new_tbody.setAttribute('id', 'inputTable');

	var tr = createTr();
	tr.appendChild(createThStr('Trip'));
	tr.appendChild(createThStr('Park'));
	tr.appendChild(createThStr('Days'));
	tr.appendChild(createThStr('Hop'));
	tr.appendChild(createThStr('Water'));
	tr.appendChild(createThStr('Daily'));
	tr.appendChild(createThStr('AP'));
	tr.appendChild(createThStr('PP'));
	new_tbody.appendChild(tr);

	for (i = 1; i <= NUM_ROWS; i++) {
		var tr = createTr();

		tr.appendChild(createTdStr('', 'Trip ' + i));

		var select = createSelect('id_park' + i, 'park' + i);
		select.appendChild(createOption('wdw', 'Walt Disney World'));
		select.appendChild(createOption('dlr', 'Disneyland'));
		tr.appendChild(createTdWithChild('', select));

		tr.appendChild(
			createTdWithChild('',
				createNumberInput('id_days' + i, 'days', 'days' + i, 0, 10, 0)
			)
		);

		tr.appendChild(
			createTdWithChild('check',
				createCheckboxInput('id_hop' + i, 'hop' + i)
			)
		);

		tr.appendChild(
			createTdWithChild('check',
				createCheckboxInput('id_water' + i, 'water' + i)
			)
		);

		tr.appendChild(
			createTdWithChild('amount',
				createLabel('id_daily' + i)
			)
		);

		tr.appendChild(
			createTdWithChild('amount',
				createLabel('id_ap' + i)
			)
		);

		tr.appendChild(
			createTdWithChild('amount',
				createLabel('id_pp' + i)
			)
		);

		new_tbody.appendChild(tr);
	}

	var tr = createTr();
	tr.appendChild(createTdStr('', 'Total'));
	tr.appendChild(createTd());
	tr.appendChild(createTd());
	tr.appendChild(createTd());
	tr.appendChild(createTd());
	tr.appendChild(
		createTdWithChild('amount',
			createLabel('id_total_daily')
		)
	);
	tr.appendChild(
		createTdWithChild('amount',
			createLabel('id_total_ap')
		)
	);
	tr.appendChild(
		createTdWithChild('amount',
			createLabel('id_total_pp')
		)
	);
	new_tbody.appendChild(tr);

	old_tbody.parentNode.replaceChild(new_tbody, old_tbody);
}

window.onload = buildInputTable;

function addInputRow()
{
	NUM_ROWS++;
	buildInputTable();
}

</script>
</head>
<body>
	Calculate Disney Tickes Prices
	<form name="inputs">
		<table>
			<tbody id="inputTable">
		</tbody>
		</table>
		<input type="button" name="calculate" value="Calculate"
			onClick="javascript:calculatePrices(this.form)">
		<input type="button" name="addRow" value="Add Row"
			onClick="javascript:addInputRow()">
	</form>
	<h3 id="id_message"></h3>
</body>
</html>
